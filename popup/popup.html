<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Autodarts League</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
<div class="app">

  <!-- ── Header ─────────────────────────────────────────── -->
  <header class="app-header">
    <div class="header-brand">
      <svg class="brand-dart" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="16" cy="16" r="15" stroke="#00d68f" stroke-width="1.8"/>
        <circle cx="16" cy="16" r="10" stroke="#00d68f" stroke-width="1.4" stroke-dasharray="3 2"/>
        <circle cx="16" cy="16" r="5"  stroke="#00d68f" stroke-width="1.4"/>
        <circle cx="16" cy="16" r="2"  fill="#00d68f"/>
      </svg>
      <span class="brand-text">Autodarts <strong>League</strong></span>
    </div>
    <div id="status-dot" class="status-dot offline" title="Backend status"></div>
  </header>

  <!-- ── View: Landing ──────────────────────────────────── -->
  <section id="view-landing" class="view active">
    <div class="hero">
      <p class="hero-sub">Round-robin leagues with real Autodarts accounts</p>
    </div>

    <button id="btn-new" class="btn btn-primary btn-full">
      <svg viewBox="0 0 20 20" fill="currentColor" width="16"><path d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"/></svg>
      New Tournament
    </button>

    <div class="section-label">Tournaments</div>
    <div id="tournaments-list" class="card-list"></div>

    <div id="offline-notice" class="notice notice-warn" style="display:none">
      <strong>Backend is offline.</strong><br>
      Run <code>./gradlew bootRun</code> inside <code>autodarts-league/</code>
    </div>
  </section>

  <!-- ── View: Setup ────────────────────────────────────── -->
  <section id="view-setup" class="view" style="display:none">
    <div class="view-topbar">
      <button class="back-btn" data-to="landing">‹ Back</button>
      <h2 class="view-title">New Tournament</h2>
    </div>

    <div class="field-group">
      <label class="field-label">Tournament Name</label>
      <input id="inp-name" class="field-input" type="text" placeholder="Friday Night League" maxlength="60">
    </div>

    <div class="field-group">
      <label class="field-label">Game Mode</label>
      <div class="chip-row" id="chips-mode">
        <button class="chip active" data-val="501">501</button>
        <button class="chip" data-val="301">301</button>
        <button class="chip" data-val="Cricket">Cricket</button>
      </div>
    </div>

    <div class="field-group">
      <label class="field-label">Best Of <span class="field-hint">(legs per match)</span></label>
      <div class="chip-row" id="chips-legs">
        <button class="chip" data-val="1">BO1</button>
        <button class="chip active" data-val="3">BO3</button>
        <button class="chip" data-val="5">BO5</button>
        <button class="chip" data-val="7">BO7</button>
      </div>
    </div>

    <div class="field-group">
      <label class="field-label">
        Rounds per Player
        <span class="field-hint">— each player faces every other player this many times</span>
      </label>
      <div class="chip-row" id="chips-rounds">
        <button class="chip" data-val="1">1×</button>
        <button class="chip active" data-val="2">2×</button>
        <button class="chip" data-val="3">3×</button>
        <button class="chip" data-val="4">4×</button>
      </div>
    </div>

    <div class="field-group">
      <div class="players-header">
        <label class="field-label">Players <span id="player-count" class="count-badge">0</span></label>
        <span class="field-hint">min 2 players</span>
      </div>
      <div class="add-player-row">
        <input id="inp-username" class="field-input" type="text" placeholder="Autodarts username">
        <button id="btn-add-player" class="btn btn-ghost">Add</button>
      </div>
      <div id="player-error" class="inline-error" style="display:none"></div>
      <div id="players-list" class="players-list"></div>
    </div>

    <button id="btn-create" class="btn btn-primary btn-full" disabled>Create Tournament</button>
  </section>

  <!-- ── View: Tournament ───────────────────────────────── -->
  <section id="view-tournament" class="view" style="display:none">
    <div class="view-topbar">
      <button class="back-btn" data-to="landing">‹ All</button>
      <div class="t-header-center">
        <h2 id="t-name" class="view-title t-name"></h2>
        <span id="t-status" class="status-pill">SETUP</span>
      </div>
      <button id="btn-refresh" class="icon-btn" title="Refresh data">
        <svg viewBox="0 0 20 20" fill="currentColor" width="16"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"/></svg>
      </button>
    </div>

    <!-- Tab Bar -->
    <div class="tab-bar">
      <button class="tab active" data-tab="standings">Standings</button>
      <button class="tab" data-tab="schedule">Schedule</button>
      <button class="tab" data-tab="next">Next Up</button>
    </div>

    <!-- Standings Tab -->
    <div id="tab-standings" class="tab-panel active">
      <table class="league-table">
        <thead>
          <tr>
            <th class="col-rank">#</th>
            <th class="col-player">Player</th>
            <th title="Played">P</th>
            <th title="Won">W</th>
            <th title="Draw">D</th>
            <th title="Lost">L</th>
            <th title="Leg difference">+/-</th>
            <th title="Points" class="col-pts">Pts</th>
          </tr>
        </thead>
        <tbody id="standings-body"></tbody>
      </table>
      <p id="standings-empty" class="empty-msg" style="display:none">No results yet — play some games!</p>
    </div>

    <!-- Schedule Tab -->
    <div id="tab-schedule" class="tab-panel" style="display:none">
      <div id="schedule-body"></div>
    </div>

    <!-- Next Up Tab -->
    <div id="tab-next" class="tab-panel" style="display:none">
      <div id="next-body"></div>
    </div>

    <!-- Bottom action bar -->
    <div id="t-actions" class="bottom-bar"></div>
  </section>

  <!-- ── Loading overlay ────────────────────────────────── -->
  <div id="loading" class="loading-overlay" style="display:none">
    <div class="spinner"></div>
  </div>

  <!-- ── Toast ──────────────────────────────────────────── -->
  <div id="toast" class="toast" style="display:none"></div>

</div><!-- .app -->
<script src="popup.js"></script>
</body>
</html>
